ARG TARGETPLATFORM=linux/amd64

ARG OS=ubuntu

FROM falkordb/falkordb-build:$OS-904ca44d1ee4e46ea983970cd1febd9a3c6c6c33 AS builder

ARG DEBUG=0

WORKDIR /FalkorDB

COPY . /FalkorDB
RUN rustup default stable
RUN make DEBUG=$DEBUG

RUN mkdir -p /FalkorDB/bin/src && cp -r /FalkorDB/bin/linux*/src/falkordb.so /FalkorDB/bin/src/falkordb.so